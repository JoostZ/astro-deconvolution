<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>AstroDeconvolution: Correction of astro photos by deconvolution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li class="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Correction of astro photos by deconvolution</h1><h2><a class="anchor" id="introduction">
Introduction</a></h2>
<p>Stars are in principle point sources. However, if we take a picture of stars, we find that the star images have a finite extension. This is caused by the atmosphere and imperfections of the telescope and recording media. This spreading of the star image can be described by <em>convolution</em>: </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[I(x, y) = \int _{-\infty} ^ {+\infty} \int _{-\infty} ^ {+\infty} PSF(x', y') S(x-x', y-y')dx' dy'\]" src="form_0.png"/>
</p>
<p> where <img class="formulaInl" alt="$S(x,y)$" src="form_1.png"/> is the real star image, <img class="formulaInl" alt="$PSF(x,y)$" src="form_2.png"/> is the <em>Point Spread Function</em> and <img class="formulaInl" alt="$I(x,y)$" src="form_3.png"/> is the resulting image.</p>
<p>Programs like IRIS allow you to do <em>deconvolution</em>, i.e., to reverse the process described above and to get an image that is a better representation of <img class="formulaInl" alt="$S(x,y)$" src="form_1.png"/>. However, this method is restricted to %PSF that are position independent. Some of the distortions that can occur in image recording have a %PSF that is position dependent. For instance, coma is a deformation that increases to the edge of the picture. Another example is a picture taken with a telescope mount where the polar axis is not perfectly aligned, causing stars to be recorded as circle segments.</p>
<p>This program is based on the article <a href="http://arxiv.org/abs/astro-ph/0208247">Deconvolution with a spatially-variant PSF</a>.</p>
<h2><a class="anchor" id="theory">
The theory</a></h2>
<p>A standard way of doing deconvolution is the <em>Lucy-Richardson Deconvolution Algorithm</em>. This algorithm starts with an original estimate of the star image <img class="formulaInl" alt="$P(x,y)$" src="form_4.png"/>. This image is then convoluted with the known PSF and the result is compared with the actual image <img class="formulaInl" alt="$I(x,y)$" src="form_3.png"/>. Based on the difference a new estimate of the star image is generated and these steps are repeated until the two images compare well.</p>
<p>By far the fastest way to do the convolutions is by means of the Fast Foerier Transform (FFT). However, this only works the PSF is constant over the area of the image.</p>
<p>As described in <a href="http://arxiv.org/abs/astro-ph/0208247">Deconvolution with a spatially-variant PSF</a> it is possible to generate a set of orthogonal base PSF, analogous to generating a set of orthogonal base vectors in an N-dimensional vector space, in such a way that each PSF can be expressed as a lineair combination of these base PSF. If we write the base PSF, that are independent of the position in the image as <img class="formulaInl" alt="$P_i(x,y$" src="form_5.png"/>, then we can write </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ P(u, v,x,y) = \sum _ {i = 1} ^ N a_i(u, v, x,y) P_i(x,y) \]" src="form_6.png"/>
</p>
<p> where <img class="formulaInl" alt="$u$" src="form_7.png"/> and <img class="formulaInl" alt="$v$" src="form_8.png"/> are the coordinates in the image and <img class="formulaInl" alt="$x$" src="form_9.png"/> and <img class="formulaInl" alt="$y$" src="form_10.png"/> are trhe coordinates in the PSF.</p>
<p>With this expression we can write the convolution of the star image with the spatially variant PSF as </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ I (x,y) = \sum _{i = 1} ^ N \int _{-\infty} ^ {+\infty} \int _{-\infty} ^ {+\infty} S(u, v) a_i (u, v) p_i (x -u, y - v)du dv \]" src="form_11.png"/>
</p>
<p>Each of the terms in this formula is now a convolution with a PSF that is spatially invariant and and can therefore be calculated with FFT.</p>
<p>This program handles correction of (astro) photos by deconvolution with a spatially-variant PSF.</p>
<h2><a class="anchor" id="algorithm">
The Algorithm</a></h2>
<p>The first step is to determine the %PSF as function of the position in the image. This program does not use theoretical formluas ot parameterized functions for the %PSF. In stead it assumes that the pixels around a star in the recorded image <em>is</em> the PSF. This is done in class PSF. </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Feb 28 11:39:42 2010 for AstroDeconvolution by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
